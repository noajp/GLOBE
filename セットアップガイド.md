# 🌍 GLOBE - セットアップガイド

## ステップ1: Xcodeプロジェクトの作成

1. **Xcodeを開く**
2. **「Create New Project」**（新規プロジェクト作成）を選択
3. **iOS → App** を選択
4. 以下の設定を入力：
   - **Product Name（製品名）**: `GLOBE`
   - **Team（チーム）**: あなたのApple Developer Team
   - **Organization Identifier（組織ID）**: `com.takanorinakano`
   - **Bundle Identifier**: 自動で `com.takanorinakano.GLOBE` になります
   - **Interface（インターフェース）**: `SwiftUI`
   - **Language（言語）**: `Swift`
   - **Use Core Data**: `チェックを外す`
   - **Include Tests**: `チェックを入れる`

5. 保存先: `/Users/nakanotakanori/Dev/GLOBE` を指定

## ステップ2: 必要なフレームワークを追加

1. ナビゲーターでプロジェクトを選択
2. GLOBEターゲットを選択
3. **「Build Phases」** → **「Link Binary With Libraries」** へ移動
4. 「+」ボタンをクリックして以下を追加：
   - `SceneKit.framework`
   - `CoreLocation.framework`
   - `MapKit.framework`

## ステップ3: Supabaseパッケージを追加

1. メニューから **File → Add Package Dependencies** を選択
2. 以下のURLを入力：
   ```
   https://github.com/supabase/supabase-swift
   ```
3. **Add Package** をクリック
4. 最新バージョンを選択してインストール

## ステップ4: 作成済みファイルをプロジェクトに追加

1. Xcodeのデフォルトの `ContentView.swift` を削除
2. Finderから `globe/` フォルダの中身をXcodeにドラッグ&ドロップ
   - ✅ 「Copy items if needed」にチェック
   - ✅ 「Create groups」を選択
   - ✅ 「Add to targets: GLOBE」にチェック

## ステップ5: STILLから認証機能をコピー

ターミナルで以下を実行：
```bash
cd /Users/nakanotakanori/Dev/GLOBE
chmod +x copy_from_still.sh
./copy_from_still.sh
```

## ステップ6: Info.plistに権限を追加

プロジェクトナビゲーターで `Info.plist` を選択し、以下を追加：

1. 「+」ボタンをクリック
2. 以下のキーと値を追加：

| キー | 値 |
|------|-----|
| Privacy - Location When In Use Usage Description | GLOBEは位置情報ベースの投稿を表示・作成するためにあなたの位置情報が必要です |
| Privacy - Location Always and When In Use Usage Description | GLOBEは3D地球上に投稿を表示するためにあなたの位置情報を使用します |
| Privacy - Camera Usage Description | GLOBEは投稿用の写真を撮影するためにカメラへのアクセスが必要です |
| Privacy - Photo Library Usage Description | GLOBEは投稿用の画像を選択するために写真ライブラリへのアクセスが必要です |

## ステップ7: Supabaseの設定

プロジェクトに `Secrets.swift` ファイルを作成：

```swift
// STILLと同じSupabase認証情報を使用
struct Secrets {
    static let supabaseURL = "あなたのSUPABASE_URL"
    static let supabaseAnonKey = "あなたのSUPABASE_ANON_KEY"
}
```

**重要**: このファイルは `.gitignore` に追加してGitにコミットしないように！

## ステップ8: アプリのエントリーポイントを置き換え

1. デフォルトの `GLOBEApp.swift` を削除
2. 作成済みの `GlobeApp.swift` を使用

## ステップ9: ビルドして実行

1. iPhone 16 Pro シミュレーターを選択
2. **⌘+R** を押して実行

## プロジェクト構造

```
GLOBE/
├── GLOBE.xcodeproj         # Xcodeプロジェクトファイル
├── globe/                   # アプリケーションコード
│   ├── Application/         # アプリのエントリーポイント
│   │   └── GlobeApp.swift  # メインアプリファイル
│   ├── Core/               # コア機能（STILLから流用）
│   │   ├── Auth/           # 認証機能
│   │   ├── Security/       # セキュリティ機能
│   │   └── Services/       # サービス層
│   └── Features/           # GLOBE独自の機能
│       └── Globe/          # 3D地球機能
│           ├── GlobeView.swift           # メインの3D地球ビュー
│           └── EarthTextureManager.swift # 地球のテクスチャ管理
└── README.md
```

## 実装済み機能

- 🌍 **3D回転する地球** - ドラッグで回転可能
- 📍 **位置ベースの投稿ピン** - 東京、NYC、パリにサンプル表示
- 🔍 **ズーム機能** - ピンチジェスチャーまたはボタンで操作
- ✨ **大気圏エフェクト** - リアルな青い大気の表現
- ☁️ **雲レイヤー** - ゆっくり回転する雲
- 🌃 **夜の都市の光** - 暗い面での都市の輝き

## 次の実装予定

- [ ] 現在地での投稿作成
- [ ] リアルタイム投稿更新
- [ ] 投稿詳細ビュー
- [ ] ユーザープロフィール
- [ ] 位置による検索
- [ ] AR モードで投稿を表示

## トラブルシューティング

### ファイルが見つからないエラーの場合
- すべてのファイルがGLOBEターゲットに追加されているか確認
- Build Phasesでファイルパスが正しいか確認

### SceneKitが動作しない場合
- SceneKit.frameworkがリンクされているか確認
- iOS Deployment Targetが15.0以上に設定されているか確認

### 認証が失敗する場合
- Supabaseの認証情報がSTILLと一致しているか確認
- Authモジュールが正しくコピーされているか確認

## アプリの実行

セットアップ後、以下が表示されるはずです：
1. **3D回転する地球**
2. **東京、NYC、パリに赤いピン**
3. **右側にズームコントロール**
4. **青い「+」ボタン（投稿作成用）**

地球をタップ&ドラッグで回転させてみてください！

## 開発のヒント

### 地球の見た目をカスタマイズ
`EarthTextureManager.swift` で以下を調整できます：
- 地球の色
- 大気の強さ
- 雲の濃さ
- 都市の光の明るさ

### 新しい場所にピンを追加
`GlobeViewModel` の `loadPosts()` メソッドで：
```swift
addPostPin(latitude: 緯度, longitude: 経度, title: "場所名")
```

### パフォーマンス最適化
多数のピンを表示する場合：
- LOD（Level of Detail）を実装
- ズームレベルに応じてピンをクラスタリング
- 表示範囲外のピンを非表示に

## 質問があれば

このプロジェクトについて質問があれば、お気軽にどうぞ！
3D地球SNSの革命を一緒に作りましょう！🌍✨